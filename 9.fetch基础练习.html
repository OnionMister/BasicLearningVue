<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <h2>
        源码：
        <a href="https://github.com/OnionMister/BasicLearningVue.git">
            <strong>https://github.com/OnionMister/BasicLearningVue.git</strong>
        </a>
    </h2>
    <hr />
    <h1>接口调用Fetch</h1>
    <ul>
        <li>fetch等同于 XMLHttpRequest。它提供了许多与XMLHttpRequest相同的功能，但被设计成更具可扩展性和高效性</li>
        <li>body类定义了arrayBuffer()、blob()、json()、text()、formData()方法，这些方法返回的都是Promise对象和数据，所以通过第二个then拿到想要的数据</li>
        <li>不管是请求还是响应都能够包含 body 对象。</li>
    </ul>
    <hr />
    <h1>1.fetch常用配置项</h1>
    <ul>
        <li>method（String）:HTTP请求方法，默认为GET，值有：GET、POST、PUT、DELETE</li>
        <li>body（String）:HTTP请求参数</li>
        <li>headers（Object）:HTTP请求头，默认为{}</li>
    </ul>
    <hr />
    <h1>2.fetch的Get请求传参</h1>
    <ul>
        <li>传统URL：‘url/http://localhost:3101/abc?id=12’。接收时，接口地址参数为：‘/abc’，方法参数为：(req,res)=>{}，使用req.query.id获取值</li>
        <li>restful形式的URL：‘url/http://localhost:3101/abc/123’。接收时接口地址参数为：‘/abc/:id’，方法参数为：(req,res)=>{}，使用req.params.id获取值
        </li>
    </ul>
    <hr />
    <h1>3.fetch的Delete请求传参</h1>
    <ul>
        <li>与get传参非常一致，更改method值为‘delete’</li>
    </ul>
    <hr />
    <h1>4.fetch的post请求传参</h1>
    <ul>
        <li>配置参数method:'post'</li>
        <li>配置参数body:'uName=lisi&pwd=111'</li>
        <li>配置参数headers:{'Content-Type':'application/x-www-form-urlencoded'}</li>
    </ul>
    <strong>注：例子：查看源码，效果见Console</strong>
    <script>
        // --------------------------------------------
        // fetch初步使用
        fetch('http://127.0.0.1:5500/BasicLearningVue/js/json/CityDictionary.json')
            .then(function (response) {
                // 除了json()还有arrayBuffer()、blob()、text()、formData()
                return response.json()
            })
            .then(function (myJson) {
                console.log(myJson);
            });
        // --------------------------------------------
        // fetch的get传参数 ---传统url
        fetch('http://localhost:3101/abc?id=123', { method: 'get' }).then(data => {
            return data.text()  // 返回Promise对象
        }).then(req => {
            console.log(req)
        });
        // fetch的get传参数 ---restful形式的url
        fetch('http://localhost:3101/abc/123', { method: 'get' }).then(data => {
            return data.text()  // 返回Promise对象
        }).then(req => {
            console.log(req)
        });
        // --------------------------------------------
        // fetch的delete传参数 ---restful形式的url
        fetch('http://localhost:3101/abc/123', { method: 'delete' }).then(data => {
            return data.text()  // 返回Promise对象
        }).then(req => {
            console.log(req)
        });
        // --------------------------------------------
        // fetch的post传参数
        fetch('http://localhost:3101/abc', { method: 'post', body: 'uName=lisi&pwd=123', headers: { 'Content-Type': 'application/x-www-form-urlencoded' } }).then(data => {
            return data.text()  // 返回Promise对象
        }).then(req => {
            console.log(req)
        });
    </script>
</body>

</html>